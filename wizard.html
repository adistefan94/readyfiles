<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Business Setup Wizard — Done Files Romania</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b1020; --card:#111836; --muted:#7b8bb2; --acc:#ffd54a; --ok:#19c37d; --danger:#ff5a5f; }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:linear-gradient(180deg,#0b1020,#0d1630 60%);color:#e7ecff;font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;}
    header{position:sticky;top:0;z-index:9;background:#0d1630b3;backdrop-filter:saturate(130%) blur(6px);border-bottom:1px solid #22305a}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    .brand .dot{width:10px;height:10px;border-radius:999px;background:var(--acc);box-shadow:0 0 16px var(--acc)}

    main{max-width:1100px;margin:24px auto;padding:0 16px;display:grid;grid-template-columns: 1.2fr 1fr;gap:20px}
    @media (max-width: 980px){ main{grid-template-columns:1fr} }

    .card{background:var(--card);border:1px solid #1c2650;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.25);}
    .card h2{margin:0;padding:18px 18px 0}
    .card .body{padding:18px}
    .pill{display:inline-flex;align-items:center;gap:8px;background:#1a244a;border:1px solid #203061;color:#cfe0ff;padding:6px 10px;border-radius:999px;font-size:12px}

    .row{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:12px;margin-top:12px}
    .row > div{background:#0f1a3b;border:1px solid #29396b;padding:12px;border-radius:12px}
    .row label{display:block;color:#b8c9ff;font-size:12px;margin-bottom:6px}
    .row .val{font-weight:700;font-size:15px}

    .controls{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
    button, .btn{appearance:none;border:0;background:#223264;color:#fff;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer;transition:transform .06s ease, background .2s}
    button:hover,.btn:hover{transform:translateY(-1px);background:#2a3a74}
    .btn-acc{background:var(--acc);color:#0b0f1f}
    .btn-acc:hover{background:#ffdf79}
    .btn-ok{background:var(--ok);color:#03120b}
    .btn-danger{background:var(--danger)}

    .muted{color:var(--muted);font-size:13px}
    hr.sep{border:0;border-top:1px dashed #2e417d;margin:14px 0}

    .checklist li{background:#0f1a3b;border:1px solid #263769;padding:12px;border-radius:10px;margin:8px 0;display:flex;gap:10px;align-items:flex-start}
    .checklist input[type=checkbox]{margin-top:3px}

    .fees{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:700px){.fees{grid-template-columns:1fr}}
    .fee-item{background:#0f1a3b;border:1px solid #263769;border-radius:10px;padding:12px}
    .fee-item .t{display:flex;justify-content:space-between}

    .tag{display:inline-block;background:#122359;border:1px solid #27408e;border-radius:8px;padding:6px 8px;font-size:12px;color:#cfe0ff;margin-right:6px}

    .footer-note{color:#98a8d6;font-size:12px;opacity:.9}

    @media print{
      header, .controls.sticky-actions{display:none}
      body{background:#fff;color:#000}
      .card{border:1px solid #ccc}
      .fee-item, .checklist li{border-color:#ccc}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap brand"><span class="dot"></span> Done Files Romania <span class="muted">· Business Setup Wizard</span></div>
  </header>

  <main>
    <section class="card" id="wizardCard">
      <h2>Tailored Checklist</h2>
      <div class="body">
        <div class="pill" id="contextPill">Loading selection…</div>
        <div class="row" style="margin-top:14px">
          <div>
            <label>Industry</label>
            <div class="val" id="valIndustry">—</div>
          </div>
          <div>
            <label>City</label>
            <div class="val" id="valCity">—</div>
          </div>
          <div>
            <label>Legal Form</label>
            <div class="val" id="valForm">—</div>
          </div>
          <div>
            <label>CAEN</label>
            <div class="val" id="valCaen">—</div>
          </div>
        </div>
        <div class="controls" style="margin-top:14px">
          <button id="changeSelectionBtn" title="Change selection">Change selection</button>
          <button class="btn-acc" id="printBtn" title="Print or save as PDF">Print / Save PDF</button>
          <button class="btn-ok" id="orderBtn" title="Order Done-For-You">Order Done‑For‑You</button>
        </div>
        <hr class="sep" />

        <h3 style="margin:0 0 8px">Required Documents</h3>
        <ul class="checklist" id="docList"></ul>

        <h3 style="margin:16px 0 8px">Extra Notes</h3>
        <div id="notes" class="muted">—</div>
      </div>
    </section>

    <aside class="card">
      <h2>Fees & Timeline</h2>
      <div class="body">
        <div class="fees" id="feesBox"></div>
        <hr class="sep" />
        <div>
          <span class="tag" id="timelineTag">Timeline: —</span>
          <span class="tag" id="caenTag">CAEN suggestions loaded</span>
        </div>
        <p class="footer-note" style="margin-top:10px">* All fees are indicative and editable. Official taxes may vary by city and changes in legislation. Keep your repo's JSON updated.</p>
      </div>
    </aside>
  </main>

  <section class="card" style="max-width:1100px;margin:12px auto;padding-bottom:8px">
    <h2>Recommended CAEN Codes</h2>
    <div class="body" id="caenBox">We’ll show 3–8 relevant CAEN classes based on your selection.</div>
  </section>

  <section class="card" style="max-width:1100px;margin:12px auto 40px">
    <h2>Questions or custom situation?</h2>
    <div class="body">
      <p class="muted">We’ll include your current selection in the message automatically.</p>
      <div class="controls sticky-actions">
        <a class="btn" id="contactBtn" href="#">Contact us</a>
        <a class="btn" id="emailBtn" href="#">Email summary</a>
      </div>
    </div>
  </section>

  <script>
    const RULES = { /* unchanged rules config */ };
    const CITY_MOD = { /* unchanged city modifiers */ };

    const $ = s => document.querySelector(s);
    const fmtMoney = n => `${Number(n).toFixed(0)} RON`;

    function getSelection(){
      const industry = localStorage.getItem('selectedIndustry') || 'IT & Software';
      const city = localStorage.getItem('selectedCity') || 'Bucharest';
      const form = localStorage.getItem('selectedForm') || 'SRL';
      const caen = localStorage.getItem('selectedCaen') || 'None';
      return {industry, city, form, caen};
    }

    function applyContextUI(ctx){
      $('#valIndustry').textContent = ctx.industry;
      $('#valCity').textContent = ctx.city;
      $('#valForm').textContent = ctx.form;
      $('#valCaen').textContent = ctx.caen;
      $('#contextPill').textContent = `Selection: ${ctx.industry} · ${ctx.city} · ${ctx.form} · CAEN: ${ctx.caen}`;
    }

    function loadRule(ctx){
      const ind = RULES[ctx.industry] || RULES['IT & Software'];
      const rule = ind[ctx.form] || Object.values(ind)[0];

      const ul = $('#docList');
      ul.innerHTML = '';
      rule.docs.forEach((d, i)=>{
        const li = document.createElement('li');
        li.innerHTML = `<input type="checkbox" id="c${i}"> <label for="c${i}">${d}</label>`;
        ul.appendChild(li);
      });

      const feesBox = $('#feesBox');
      feesBox.innerHTML = '';
      const fees = {...rule.fees};
      const cityDelta = CITY_MOD[ctx.city];
      if(cityDelta && cityDelta.feesDelta){
        for(const k in cityDelta.feesDelta){
          fees[k] = (fees[k] || 0) + cityDelta.feesDelta[k];
        }
      }
      Object.entries(fees).forEach(([k,v])=>{
        const el = document.createElement('div');
        el.className = 'fee-item';
        el.innerHTML = `<div class="t"><strong>${k}</strong><span>${fmtMoney(v)}</span></div>`;
        feesBox.appendChild(el);
      });

      $('#timelineTag').textContent = `Timeline: ${rule.timeline}`;
      let notes = rule.notes || '';
      if(cityDelta && cityDelta.notesAdd){ notes += (notes? ' ' : '') + cityDelta.notesAdd; }
      $('#notes').textContent = notes || '—';

      const caenBox = $('#caenBox');
      caenBox.innerHTML = '';
      (rule.caen||[]).forEach(c=>{
        const div = document.createElement('div');
        div.className = 'fee-item';
        div.innerHTML = `<div class="t"><strong>${c.cod}</strong><span>${c.title}</span></div>`;
        caenBox.appendChild(div);
      });
    }

    function openMailTo(subject, body){
      const mail = 'contact@donefiles.com';
      window.location.href = `mailto:${mail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    }

    function buildSummaryText(ctx){
      const docs = [...document.querySelectorAll('#docList label')].map(x=>`- ${x.textContent}`).join('\n');
      const fees = [...document.querySelectorAll('#feesBox .t')].map(x=>{
        const [k, v] = x.textContent.split(/(?=\d)/);
        return `- ${k.trim()}: ${v.trim()}`;
      }).join('\n');
      const notes = $('#notes').textContent.trim();
      return `Selection:\nIndustry: ${ctx.industry}\nCity: ${ctx.city}\nForm: ${ctx.form}\nCAEN: ${ctx.caen}\n\nRequired documents:\n${docs}\n\nFees:\n${fees}\n\nTimeline: ${$('#timelineTag').textContent.replace('Timeline: ','')}\nNotes: ${notes}`;
    }

    const ctx = getSelection();
    applyContextUI(ctx);
    loadRule(ctx);

    $('#printBtn').addEventListener('click', ()=> window.print());
    $('#changeSelectionBtn').addEventListener('click', ()=>{ window.location.href = 'index.html'; });
    $('#orderBtn').addEventListener('click', ()=>{
      const text = buildSummaryText(ctx) + "\n\nI want the Done‑For‑You service.";
      openMailTo('Order — Done‑For‑You', text);
    });
    $('#contactBtn').addEventListener('click', (e)=>{
      e.preventDefault();
      const text = buildSummaryText(ctx) + "\n\nQuestion:";
      openMailTo('Question about setup', text);
    });
    $('#emailBtn').addEventListener('click', (e)=>{
      e.preventDefault();
      const text = buildSummaryText(ctx);
      openMailTo('My setup summary', text);
    });
  </script>
</body>
</html>
